# Grundlagen der qualtitativen Datenanalyse
```{r}
#| include: false

library(ggplot2)
library(ggdag)
```
```{r child="FarbSchema.qmd"}
```
```{r DAGS}
#| include: false

textsize <- 5
nodesize <- 14
labelsize <- 5
margins <- unit(c(0.2, -1, -2, -2), "mm") # t r b l

# Experiment
co <- data.frame(
  x = c(0, 0, 1), 
  y = c(1, 0, 0), 
  name = c("Z", "X", "Y")
) 

dag_e1 <- dagify(
  Y ~ X,
  X ~ Z,
  Y ~ Z, 
  coords = co) |> 
    ggdag(
      node_size = nodesize, 
      text_size = textsize, 
      text = TRUE, 
      text_col = bgcolGray) + 
    theme_dag_blank() +
    geom_dag_edges(
      arrow_directed = grid::arrow(length = grid::unit(15, "pt"), 
      type = "closed")
    )  + 
    geom_text(
      label = "Z - Vorwissen\nX - Lernzeit\nY - Klausurpunkte", 
      hjust = 1, 
      vjust = 1,
      x = 1, 
      y = 1, 
      size = labelsize, 
      color = fgcolGray) +
    labs(title = " Beobachtungsstudie") +
    theme(plot.margin = margins)

co <- data.frame(x = c(0,0,1,-1), y = c(1,0,0,0), name = c("Z", "X", "Y", "D")) 

dag_e2 <- dagify(
  Y ~ X,
  X ~ Z,
  X ~ D,
  Y ~ Z, 
  coords = co) |> 
    ggdag(
      node_size = nodesize, 
      text_size = textsize, 
      text = TRUE, 
      text_col = bgcolGray) + 
    theme_dag_blank() +
    geom_dag_edges(
      arrow_directed = grid::arrow(
        length = grid::unit(15, "pt"), 
        type = "closed")
      )  + 
    geom_segment(
      aes(x = -.1, y = .475, xend = .1, yend = .575), 
      color = fgcolGray) +
    geom_segment(aes(x = -.1, y = .425, xend = .1, yend = .525), color = fgcolGray) +
    geom_text(label = "Z - Vorwissen\nX - Lernzeit\nY - Klausurpunkte\nD - Dozentin", 
            hjust = 0, vjust = 1,
            x = -1.15, y = 0.85, size = labelsize, color = fgcolGray) +
  labs(title = " Randomisiertes Experiment") +
  theme(plot.margin = margins)

# Stichprobe

co <- data.frame(x = c(0.5,0,1), y = c(1,0,0), name = c("Z", "S", "X")) 

dag_s1 <- dagify(S ~ Z,
               X ~ Z,
               coords = co) |> 
  ggdag(node_size = nodesize, text_size = textsize, text = TRUE, text_col = bgcolGray) + 
  theme_dag_blank() +
  geom_dag_edges(arrow_directed = grid::arrow(length = grid::unit(15, "pt"), type = "closed"))  + 
  geom_text(label = "Z - Gewissenhaftigkeit\nS - Stichprobe\nX - Lernzeit", 
            hjust = 0, vjust = 0,
            x = 0.15, y = -0.05, size = labelsize, color = fgcolGray) +
  labs(title = " Gelegenheitsstichprobe") +
  theme(plot.margin = margins) 

co <- data.frame(x = c(0.5,0,1,-1), y = c(1,0,0,0), name = c("Z", "S", "X", "D")) 

dag_s2 <- dagify(X ~ Z,
               S ~ Z,
               S ~ D, coords = co) |> 
  ggdag(node_size = nodesize, text_size = textsize, text = TRUE, text_col = bgcolGray) + 
  theme_dag_blank() +
  geom_dag_edges(arrow_directed = grid::arrow(length = grid::unit(15, "pt"), type = "closed"))  + 
  geom_segment(aes(x = .15, y = .475, xend = .35, yend = .575), color = fgcolGray) +
  geom_segment(aes(x = .15, y = .425, xend = .35, yend = .525), color = fgcolGray) +
  geom_text(label = "Z - Gewissenhaftigkeit\nS - Stichprobe\nX - Lernzeit\nD - Dozentin", 
            hjust = 0, vjust = 1,
            x = -1.1, y = 0.85, size = labelsize, color = fgcolGray) + 
  labs(title = " Zufallsstichprobe") +
  theme(plot.margin = margins)

#  pkgsrm(pkgsinit)

```
```{r setup-chapter-4}
#| include: false
library(ggplot2)
library(ggdag)

library(emojifont)
library(purrr)
library(tidyr)
library(ggformula)
library(mosaic)
library(gridExtra)

# Aufgabenverwaltung initialisieren
ch <- 4
quiz <- 0
```

::: {.callout-tip .Lernergebnisse}
## Lernergebnisse dieses Kapitels

Nach erfolgreichem Abschluss dieses Kapitels sind Sie in der Lage,

-   eine Messung zu definieren und verschiedene Typen von Skalenniveaus sicher zu unterscheiden;
-   Grundbegriffe der quantitativen Datenanalyse (wie Unabh√§ngige Variable, Abh√§ngige Variable) und Probleme erkl√§ren, die aufgrund der Nichtber√ºcksichtigung von Drittvariablen auftreten k√∂nnen;
-   zentrale Begriffe um Stichproben(arten) und Populationen zu erl√§utern;
-   die Unterschiede hinsichtlich Zufall und Kausalit√§t bei Beobachtungs- vs. Experimentalstudien zu erkennen;
-   die Phasen des PPDAC-Zyklus zu nennen und anhand von Beispielen zu illustrieren.
:::

## Grundbegriffe

Um Daten zu erheben, m√ºssen Messungen durchgef√ºhrt werden. Der Eigenschaft eines Objektes wird dabei ein Wert zugewiesen. Dazu muss nicht immer ein Messger√§t verwendet werden, auch das Nachschlagen des Umsatzes in einem Gesch√§ftsbericht f√ºhrt zu Daten. Das, was gemessen wird, bezeichnen wir als Variable. Es gibt zwei Typen von Variablen:

-   **Manifeste Variablen:** Der Wert kann direkt gemessen werden, z. B. Gr√∂√üe, Gewicht, Umsatz.
-   **Latente Variablen:** Diese k√∂nnen nicht direkt gemessen werden, sie m√ºssen erst durch ein Konstrukt **operationalisiert** werden, z. B. Intelligenz, Leichtigkeit beim Verst√§ndnis von Statistik, Innovationsst√§rke eines Unternehmens.

Eine Operationalisierung erfolgt im Zusammenhang mit Umfragen h√§ufig mittels einer **Multi-Item-Likert-Skala**. Dabei werden auf einer Skala z. B. von eins (trifft √ºberhaupt nicht zu) bis sieben (trifft voll oder ganz zu) Aussagen bewertet, die im Zusammenhang mit der betreffenden latenten Variablen stehen.

::: column-margin
*Beispiel f√ºr eine Multi-Item Likert-Skala:*\

Leichtigkeit beim Verst√§ndnis von Statistik Bewertung der Aussagen auf einer Skala von 1 (trifft √ºberhaupt nicht zu) √ºber 4 (weder zutreffend, noch unzutreffend) bis 7 (trifft voll und ganz zu) \[\* inverse Items\]

-   Statistische Formeln sind leicht zu verstehen.
-   Statistik ist ein kompliziertes Fach.\*
-   Statistik ist ein Fach, das die meisten Menschen schnell lernen.
-   Das Lernen von Statistik erfordert sehr viel Disziplin.\*
-   Statistik beinhaltet sehr umfangreiche Rechnungen.\*
-   Statistik ist eine sehr technische Materie.\*
-   Die meisten Menschen m√ºssen lernen anders zu denken, um Statistik anwenden zu k√∂nnen.\*
:::

Ein Beispiel f√ºr eine solche Multi-Item-Likert-Skala ist die Operationalisierung des Verst√§ndnisses von Statistik ^[@schau]. Manche der Items sind sogenannte inverse Items (im Beispiel mit \* markiert), die Zustimmung geht also in die umgekehrte Richtung. Aus allen Werten wird dann der Mittelwert gebildet, dazu m√ºssen die inversen Items zun√§chst umgedreht werden (auf einer siebenstufigen Skala wird so z. B. aus einer zwei eine sechs). Der sich ergebende Mittelwert ist dann der Wert, der der betreffenden Variablen f√ºr diese Beobachtung zugewiesen wird.


Auch hier kehren die G√ºtekriterien wieder, jetzt bezogen auf die Messung. Im Einzelnen sind dies **Genauigkeit**, **Objektivit√§t**, **Reliabilit√§t** (Zuverl√§ssigkeit einer Messung, wiederholte Messungen ergeben ein vergleichbares Ergebnis) und **Validit√§t** (es wird das gemessen,was gemessen werden soll).

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

Vergleichen Sie die G√ºtekriterien der Messung mit denen der Forschung. Wo gibt es Gemeinsamkeiten, wo Unterschiede?
:::

@fig-VarianzBias zeigt exemplarisch, was bei einer Messung *schief* gehen kann. Entweder streut das Messergebnis (Varianz) oder die Messung hat eine Abweichung (Verzerrung oder Bias), beispielsweise eine Waage, die verstellt ist.

```{r fig-VarianzBias}
#| echo: false
#| fig-cap: "Varianz (Streuung) einer Messung (links), Verzerrung einer Messung (rechts)"
#| fig-width: 5
#| fig-asp: 0.54
#| out-width: 10cm
#| label: fig-VarianzBias
 
  set.seed(2009)
  
  theta <- seq(0, 2 * pi, length = 360)
  r <- c(0.1,0.25,0.5,0.75,1)
  radius <- rep(r, each = length(theta))
  
  zielscheibe_df <- data.frame(
    radius = radius,
    x = radius * cos(theta), 
    y = radius * sin(theta)
  )
  
  varianz <- data.frame(
    x = scale(rnorm(10))/3,
    y = scale(rnorm(10))/3
  )
  
  verzerrung <- data.frame(
    x = rnorm(10, mean = 1, sd = 0.3)/3,
    y = rnorm(10, mean = 1, sd = 0.3)/3
  )
  
  zielscheibe <- ggplot()
  
  ringe <- zielscheibe_df |> group_by(radius) |>
    do(
      geom = geom_path(mapping=aes(x = x, y = y), data = . )
    )
  
  for (i in 1:length(r)) {
    zielscheibe <- zielscheibe + ringe$geom[i]
  }
  
  plotVar <- zielscheibe
  plotVerz <- zielscheibe
  
  # ToDo: Hier geht |> nicht - kl√§ren warum
  plotVar <- plotVar + varianz %>%       
    geom_point(
      data = ., 
      mapping = aes(x = x, y = y),         
      size = 2.5,
      color =  fgcolFOMGreen
    ) +  
    ggtitle("Varianz") + 
    theme_void() + 
    theme(
      plot.margin = unit(c(-1.5, 0, -2.5, -2.5), "mm"), # t r b l
      plot.title = element_text(
        size = 11, 
        # face = "bold", 
        hjust = 0.5
      )
    )
  
  plotVerz <- plotVerz + verzerrung %>%  # dito
    geom_point(
      data = ., 
      mapping = aes(x = x, y = y), 
      size = 2.5,
      color =  fgcolFOMGreen
    ) + 
    ggtitle("Verzerrung") + 
    theme_void() + 
    theme(
      plot.margin = unit(c(-1.5, -2.5, -2.5, 0), "mm"),
      plot.title = element_text(
        size = 11, 
        # face = "bold", 
        hjust = 0.5
      )
    ) 
  grid.arrange(plotVar, plotVerz, ncol = 2)
```

Eine hohe Varianz bedeutet eine geringe Reliabilit√§t, eine gro√üe Verzerrung f√ºhrt zu einer geringen Validit√§t. Das Thema wird uns auch in sp√§teren Kapiteln besch√§ftigen -- wirwerden lernen,was wir beeinflussen, was wir kontrollieren k√∂nnen.

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

Ist es bei 20 Grad Celsius doppelt so warm wie bei 10 Grad Celsius? Begr√ºnden Sie Ihre Antwort.
:::

::: {.callout-tip .Tipp}
## Tipp

Beantworten Sie die Frage, bevor Sie weiterlesen. 
Versuchen Sie erst selbst die L√∂sung zu finden. 
Das ist der Schl√ºssel f√ºr Ihren Lernerfolg!
:::

Daten k√∂nnen auf unterschiedlichen Skalen gemessen werden. Um das Skalenniveau von Daten, d. h. um den Informationsgehalt. 
Zwei grunds√§tzliche Eigenschaften gibt es dabei: **kategorial** und **metrisch**.

Die kategoriale Skale wird auch als qualitative Skala bezeichnet, es geht um Eigenschaften. 
Wenn Sie eine Eigenschaft nur zuordnen k√∂nnen, hei√üt die Skala **nominal**, z. B. Industriesektoren oder L√§nder.

K√∂nnen Sie die Eigenschaften ordnen? Dann liegen sie auf einer **Ordinalskala** vor. 
Beispiele daf√ºr sind Bildungsabschl√ºsse oder G√ºtesterne von Hotels.

Die metrische Skala wird auch als quantitative Skala bezeichnet. 
Wenn Sie nur die die Abst√§nde inhaltlich sinnvoll interpretiert k√∂nnen, liegen die Daten auf einer **Intervallskala** vor, ein Beispiel w√§re die Temperatur in ¬∞C. 
K√∂nnen auch die Quotienten sinnvoll interpretiert werden, liegen die Daten auf einer **Verh√§ltnisskala** vor, z. B. Gr√∂√üe in cm, Umsatz in Euro. 
Beispiele: 2 m ist doppelt so lang wie 1 m, aber 20 ¬∞C ist nicht doppelt so warm wie 10 ¬∞C -- inhaltlich ist die zweite Aussage nicht sinnvoll. 
Im Fall der Intervallskala ist der Nullpunkt gesetzt, w√§hrend es bei der Verh√§ltnisskala einen nat√ºrlichen Nullpunkt gibt. 
Daten auf der Intervallskala k√∂nnen Sie mit Faktor und Offset umrechnen (z. B. von der Celsius- zur Fahrenheitskala), w√§hrend Sie Daten auf der Verh√§ltnisskala nur mit einem Faktor umrechnen k√∂nnen (z. B. Meter in Inch).

::: {.callout-tip .Tipp}
## Tipp

Eigenschaften werden in *Kategorien* angegeben, daher *kategoriale* Daten. 
Wenn Sie etwas *messen* k√∂nnen (quasi mit dem Ma√üband oder dem Zollstock), sind es *metrische* Daten.
:::

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

Welches Skalenniveau hat die Variable Telefonvorwahl?
:::

Metrische Daten werden zus√§tzlich in **stetig** und **diskret** unterteilt. 
Stetige Daten k√∂nnen beliebig viele Zwischenwerte (Nachkommastellen) haben, je nach Genauigkeit des Messintruments, z. B. L√§nge. 
Diskrete Daten haben abz√§hlbar viele Zwischenwerte, meist sind sie ganzzahlig. 
Ein Beispiel daf√ºr ist die Anzahl Studierender in einer Veranstaltung. 
Manchmal gibt es auch Daten, die z. B. auf zwei Nachkommastellen diskret sind wie Geldbetr√§ge in Euro.
Da es dann aber sehr viele Stufen gibt, werden sie als **quasi-stetig** bezeichnet und wie stetige Werte behandelt.

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

H√∂ren Sie zur Entspannung folgenden Song: Levels of Measurement &copy; Larry Lesser und Dominic Dousa, [www.causeweb.org](https://www.causeweb.org/cause/resources/fun/songs/levels-measurement).
:::

::: {.callout-tip .Tipp}
## Tipp

Sie finden an vielen Stellen Verweise auf Songs und Videos. Wenn Sie Spa√ü daran haben, h√∂ren oder schauen Sie sich diese an. 
Es lockert den Ablauf auf und bewirkt eine zus√§tzliche Verfestigung des Lernstoffes.
:::

::: column-margin

| Name  | Geschlecht | Gr√∂√üe |
|:-----:|:----------:|:-----:|
| Ahmet | m          | 180   |
| Gabi  | w          | 170   |
| Max   | m          | 186   |
| Susi  | w          | 172   |

: Exemplarischer Datensatz {#tbl-Data}

:::

@tbl-Data zeigt einen exemplarischen Datensatz. 
Ein Datensatz ist meist wie ein Tabellenkalkulationsblatt aufgebaut. 
Daten werden h√§ufig auch in Formaten abgespeichert, die von Tabellenkalkulationsprogrammen (wie Excel, Numbers o. √§.) gelesen werden k√∂nnen.

Die Spalten entsprechen in der Regel einer Variablen, hier Name, Geschlecht und Alter, eine Zeile zeigt eine Beobachtung. 
H√§ufig ist die erste Zeile in einem Datensatz die Kopfzeile, gibt also die Namen der Variablen aus.

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)` 

Lesen Sie Kapitel 1 aus dem Buch *Introduction to Modern Statistics* \[6\]. Sie k√∂nnen es hier herunterladen: <https://openintro-ims.netlify.app/index.html>
:::

Puh, das ist ja auf Englisch! Ja, Sie haben Recht, aber es liest sich gut (viele englischsprachige B√ºcher lassen sich eigentlich besser lesen als vergleichbare deutschsprachige) und passt inhaltlich sehr gut zu unserem Thema.

Und nebenbei k√∂nnen Sie so Ihre Kompetenzen erweitern.

Messwerte einer Variablen k√∂nnen streuen (das hatten wir schon bei der Messung der Daten). Aber Daten k√∂nnen auch aus anderen Gr√ºnden streuen: zuf√§llig, aufgrund der Messung (unerw√ºnscht), aufgrund der Stichprobe oder systematisch.

Ziel in der quantitativen Datenanalyse ist h√§ufig, beobachtete Daten zu modellieren, d. h., ein Modell zu finden, was einen Teil der systematischen Variation erkl√§rt.

::: center
Daten = Modell + Rest
:::

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

√úberlegen Sie sich, warum Punkte einer Klausur variieren.
:::

Wir versuchen oft, den Zusammenhang zwischen verschieden Variablen herzustellen (z. B. Punkte in einer Klausur h√§ngen zusammen mit dem Zeitaufwand, mit dem gelernt wurde).

In Zusammenhang mit der Modellformulierung gibt es folgende Bezeichnungen:

-   **Abh√§ngige Variable:** Der Wert h√§ngt von der oder den unabh√§ngigen Variablen ab; auch endogene oder erkl√§rte Variable, meist mit $ùë¶$ symbolisiert.

-   **Unabh√§ngige Variable:** Der Wert h√§ngt (im Idealfall) von keiner anderen Variable ab; auch exogene oder erkl√§rende Variable, meist mit $ùë•$ symbolisiert.

-   **Kovariable:** eine oder mehrere weitere Variablen, die ebenfalls die abh√§ngige Variable oder den Zusammenhang zwischen der abh√§ngigen und den unabh√§ngigen Variablen beeinflussen. Diese werden auch als St√∂rvariablen bezeichnet ( $ùëß$ ).

Die Entscheidung dar√ºber, was eine unabh√§ngige Variable und was eine Kovariable ist, h√§ngt i. d. R. von der Fragestellung ab, die untersucht wird.

Die Modellformulierung in der Statistik lautet $ùë¶ ‚àº ùë•$ . Im Unterschied zur mathematischen Funktion \$ùë¶ = ùëì (ùë•) \$ kann es in der statistischen Formulierung f√ºr ein $ùë•$ auch mehrere $ùë¶$ -Werte geben.

Dass Sie bei der Auswahl der Kovariablen aufpassen m√ºssen, zeigt @fig-UCBEins, in der es um Zulassungen an der University of California Berkeley im Zusammenhang mit dem Geschlecht geht (Bickel, Hammel und O'Connell @bickel1975).


```{r fig-UCB1}
#| echo: false
#| label: fig-UCBEins
#| fig-cap: "Zulassungen an der UC Berkeley in Abh√§ngigkeit vom Geschlecht: ohne Kovariable"
#| fig-width: 5
#| fig-asp: 1
#| out-width: 7cm
#| out-extra: trim = 10mm 15mm 10mm 5mm, clip
mosaicplot(apply(UCBAdmissions, c(1, 2), sum) |> t(), 
           main = "Zulassungen an der UC Berkeley",
           col = c(bgcolGray, bgcolFOMGreen), cex.axis = 1)
```

Das ist ein Beispiel des sogenannten Simpson-Paradox. Das Weglassen der Kovariable Department verzerrt das Bild. Es wirkt so, als ob Frauen benachteiligt w√ºrden.

Erst die Aufteilung nach der Kovariable Department (@fig-UCB2) zeigt, dass Frauen und M√§nner ausgeglichen zugelassen wurden, im Department A sogar relativ mehr Frauen. Die Verzerrung im Gesamtbild ergibt sich durch die Wahl der Departments: Frauen haben sich eher dort beworben, wo die Ablehnungsquote h√∂her ist.

```{r fig-UCB2}
#| echo: false
#| label: fig-UCB2
#| fig-width: 6.5
#| fig-asp: 0.8
#| out-width: 10cm
#| fig-cap: "Zulassungen an der UC Berkeley in Abh√§ngigkeit vom Geschlecht: mit Kovariable Department"

opar <- par(mfrow = c(2, 3), oma = c(0, 0, 2, 0)) # b, l, t , r
for (i in 1:6)
  mosaicplot(UCBAdmissions[, , i] |> t(),
#    xlab = "Admit", ylab = "Gender",
    main = paste("Department", LETTERS[i]), 
    col = c(bgcolGray, bgcolFOMGreen))
mtext(expression(bold("Zulassungen an der UC Berkeley")),
      outer = TRUE, cex = 1.2)
par(opar)
```

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

Recherchieren Sie, wer Simpson war und warum das Paradox nach ihm benannt wurde.
:::

Wir werden uns im Kapitel Kausale Modellierung systematisch mit der Auswahl von Kovariablen besch√§ftigen, so dass Verzerrungen vermieden werden k√∂nnen.

## Datenerhebung

Die Datenerhebung f√ºr unsere Untersuchungen erfolgt i. d. R. als **Stichprobe**. Eine Stichprobe ist eine Teilmenge einer **Population** (oder **Grundgesamtheit**). H√§ufig k√∂nnen wir gar nicht die gesamte Population erheben (wir sollen wir z. B. alle Studierenden der FOM erreichen) oder es ist technisch nicht m√∂glich (z. B. Werkstoffpr√ºfung, in der das Untersuchungsobjekt zerst√∂rt wird).

Idealerweise wird eine **Zufallsstichprobe** gezogen, in der alle Beobachtungen der Population die gleiche Wahrscheinlichkeit haben, Teil der Stichprobe zu werden. Eine nicht-zuf√§llige Stichprobe wird als **Gelegenheitsstichprobe** bezeichnet. Die Population kann auch nach geeigneten Kriterien aufgeteilt werden und aus den einzelnen Gruppen werden wiederum Zufallsstichproben gezogen: eine **geschichtete** oder **stratifizierte** Stichprobe.

@fig-Sample zeigt die verschiedenen Erhebungsm√∂glichkeiten schematisch.

```{r fig-Sample, fig = TRUE}
#| echo: false
#| label: fig-Sample
#| fig-width: 5
#| fig-asp: 0.6
#| out-width: 10cm
#| fig-cap: "Verschiedene Erhebungsmethoden f√ºr Stichproben"

fa1 <- fontawesome(c("fa-user"))
fa2 <- fontawesome(c("fa-female", "fa-male"))
fasize <- 4
titlesize <- 9

set.seed(42)
d <- crossing(x = 1:10,
              y = 1:10) |>
  mutate(label = sample(x = c(rep(1, 20), rep(0, 80))) |> as.factor()) |>
  mutate(label2 = c(rep(1, 20), rep(0, 80)) |> as.factor(),
         label3 = c(sample(x = c(rep(1, 10), rep(0, 40))),
                    sample(x = c(rep(1, 10), rep(0, 40)))),
         group = c(rep(fa2[1], 50), rep(fa2[2], 50))) |>
  mutate(label3 = as.factor(label3),
         label4 = rep(1, 100) |>
         as.factor())

p1 <- ggplot(d, aes(x = x, y = y, color = label)) +
  geom_tile(color = "white", linewidth = .5, aes(fill = label), alpha = .2) +
  theme_void() +
  geom_text(family = 'fontawesome-webfont', size = fasize, label = fa1) +
  scale_color_manual(label = c("nicht-gew√§hlt", "gew√§hlt"),
                     values = c(fgcolGray, fgcolFOMGreen),
                     name = "") +
  scale_fill_manual( values = c(fgcolGray, fgcolFOMGreen)) +
  labs(title = "Zufallstichprobe\n") +
  theme(legend.position = "none", 
        plot.title = element_text(size = titlesize, hjust = 0.5),
        plot.margin = unit(c(0, 0, -3, 0), "mm")) +
  guides(fill = "none")  # was FALSE


p2 <- ggplot(d, aes(x = x, y = y, color = label2)) +
  geom_tile(color = "white", linewidth = .5, aes(fill = label2), alpha = .2) +
  theme_void() +
  geom_text(family = 'fontawesome-webfont', size = fasize, label = fa1) +
  scale_color_manual(label = c("nicht-gew√§hlt", "gew√§hlt"),
                     values = c(fgcolGray, fgcolFOMGreen),
                     name = "") +
  scale_fill_manual( values = c(fgcolGray, fgcolFOMGreen)) +
  labs(title = "Gelegenheits-\nstichprobe") +
  theme(legend.position = "none", 
        plot.title = element_text(size = titlesize, hjust = 0.5),
        plot.margin = unit(c(0, 0, -3, 0), "mm")) +
  guides(fill = "none")  # was FALSE


p3 <- ggplot(d, aes(x = x, y = y, color = label3)) +
  geom_tile(color = "white", linewidth = .5, aes(fill = label3), alpha = .2) +
  theme_void() +
  geom_text(family='fontawesome-webfont', size = fasize, aes(label = group)) +
  scale_color_manual(label = c("nicht-gew√§hlt", "gew√§hlt"),
                     values = c(fgcolGray, fgcolFOMGreen),
                     name = "") +
  scale_fill_manual( values = c(fgcolGray, fgcolFOMGreen)) +
  labs(title = "Geschichtete\nZufallsstichprobe") +
  theme(legend.position = "none", 
        plot.title = element_text(size = titlesize, hjust = 0.5),
        plot.margin = unit(c(0, 0, -3, 0), "mm")) +  # t r b l
  guides(fill = "none")  + # was FALSE
  geom_vline(xintercept = 5.5, linetype = "dashed")


p4 <- ggplot(d, aes(x = x, y = y, color = label4)) +
  geom_tile(color = "white", linewidth = .5, fill = fgcolFOMGreen, alpha = .2) +
  theme_void() +
  geom_text(family = 'fontawesome-webfont', size = fasize, label = fontawesome("fa-user")) +
  scale_color_manual(label = "gew√§hlt",
                     values = fgcolFOMGreen,
                     name = "") +
  scale_fill_manual(values = fgcolFOMGreen) +
  labs(title = "Vollerhebung\n") +
  theme(legend.position = "none", 
        plot.title = element_text(size = titlesize, hjust = 0.5),
        plot.margin = unit(c(0, 0, -3, 0), "mm")) +
  guides(fill = "none")  # was FALSE


grid.arrange(p1, p2, p3, p4, nrow = 1)
```


Warum ist es ideal, eine Zufallsstichprobe zu haben? Wenn ich Ihren Kurs als Stichprobe f√ºr die Studierenden der FOM nehmen w√ºrde, k√∂nnten meine Ergebnisse verzerrt sein (z. B. wenn ich mich f√ºr das Monatseinkommen interessiere). Ich erreiche so nur Bachelorstudierende und ggf. auch nur aus einem Zeitmodell. Besser w√§re es hier z. B. eine geschichtete Stichprobe (nach Studieng√§ngen, Zeitmodellen und Standorten) zu ziehen.

In anderen Fragestellungen mag die Gelegenheitsstichprobe *Ihr Kurs* nicht verzerrt sein, z. B. wenn ich mich f√ºr die K√∂rpergr√∂√üe interessiere. Es h√§ngt also immer auch von der Fragestellung ab, ob eine Gelegenheitsstichprobe geeignet ist.

::: {.callout-note .Aufgabe}
## Aufgabe `r quiz <- quiz + 1; paste0(ch, ".", quiz)`

Verzerrungen

a)  Was glauben Sie: Welche der nachfolgend aufgef√ºhrten Gruppen hat eine h√∂here Wahrscheinlichkeit, an einer freiwilligen Umfrage der Dozentin teilzunehmen? Die Gruppe der nicht besonders gewissenhaft Studierenden, die Gruppe der besonders gewissenhaft Studierenden oder beide gleich Gruppen gleich.

b)  Was glauben Sie: Welche Gruppe verwendet durchschnittlich mehr Zeit zur Vor- und Nacharbeit der Vorlesungsinhalte oder verwenden beide etwa gleich viel Zeit?
:::

::: column-margin
[![](causeweb-images/cartoon0118.jpg)](https://www.causeweb.org/cause/sites/default/files/caption_contest/2018/Caption-Contest_01-2018.jpg) Gelegenheitsstichproben erreichen nur die niedrig h√§ngenden Fr√ºchte. [https://www.CAUSEweb.org](https://www.causeweb.org/cause/caption-contest/january/2018/results) &copy; J. B. Landers, Bildunterschrift L. Lesser
:::

Ein fiktives Beispiel:

-   Sei $Z$ die Gewissenhaftigkeit eines Studierenden.

-   Sei $S$ die Teilnahme an einer Umfrage. D. h., an $S$ kann erkannt werden, ob die Person Teil der Stichprobe ist oder nicht.

-   Sei $X$ die Lernzeit eines Studierenden. Diese m√∂chte die Dozentin analysieren.

Es kann vermutet werden:

-   Gewissenhaftere Studierende haben eine h√∂here Bereitschaft zur Teilnahme an der Umfrage: $Z \xrightarrow{+} S$ .

-   Gewissenhaftere Studierende haben eine l√§ngere Lernzeit: $Z \xrightarrow{+} X$ .

Insgesamt hat daher die Gelegenheitsstichprobe eine h√∂here Lernzeit als die Population, da die Studierenden mit einer geringeren Gewissenhaftigkeit, und daher auch Lernzeit, in der Stichprobe fehlen.

Durch eine zuf√§llige Stichprobe wird diese *Selbst-Selektion* vermieden.

@fig-DAG-Stichprobe zeigt den datengenerierenden Prozess einer Gelegenheitsstichprobe und einer zuf√§lligen Stichprobe. Bei letzterer w√§hlt die Dozentin die Studierenden zuf√§llig aus.

```{r fig-DAG-Stichprobe}
#| fig-cap: "Gelegenheitsstichprobe vs. Zufallsstichprobe"
#| label: fig-DAG-Stichprobe
#| echo: FALSE
#| fig-width: 7
#| fig-asp: 0.5
#| out-width: 10cm

layout <- rbind(c(rep(1,10), NA, rep(2, 10)))
grid.arrange(dag_s1, dag_s2, layout_matrix = layout)
```

Durch die Zufallsstichprobe wird der Weg von Gewissenhaftigkeit (gewissenhaftere Menschen nehmen eher an Umfragen teil) zur Stichprobe unterbrochen, so dass es in der Umfrage zur Lernzeit keine *Selbst-Selektion* gibt (gewissenhaftere Menschen werden auch eine h√∂here Lernzeit haben).

::: {.callout-tip .Hinweis}
## Hinweis
Die Abbildung zeigt einen sogenannten *Directed Acyclic Graph*, kurz DAG. 
Damit k√∂nnen kausale Zusammenh√§nge dargestellt werden. 
Mehr dazu im Kapitel 9 (Einf√ºhrung in die kausale Modellierung).
:::

Der Wert in der Population, der von Interesse ist, wird als Parameter bezeichnet. Ein Parameter wird i. d. R. mit griechischen Buchstaben bezeichnet, z. B. $\mu$ f√ºr den Erwartungswert der Population (also der Mittelwert √ºber die gesamte Population) oder $\pi$ f√ºr den Anteil in der Population. Den Wert, den ich stattdessen aus der Stichprobe messe, ist die (Stichproben-)Statistik oder der Sch√§tzwert. Diese werden h√§ufig mit lateinischen Buchstaben bezeichnet, z. B. $\bar{x}$ f√ºr den Mittelwert der Stichprobe.

@tbl-griBuchstaben zeigt einige griechische Buchstaben, die in der quantitativen Datenanalyse h√§ufiger verwendet werden.

```{r}
#| label: tbl-griBuchstaben
#| tbl-cap: "Griechische Buchstaben in der Statistik"
#| echo: false
#| warning: false

tribble(
  ~grBuchstaben, ~Buchstabe, ~Bedeutung,
  "$\\alpha$"  , "*alpha*"    , "-- Symbol f√ºr das Signifikanzniveau eines Tests<br>-- auch Zeichen f√ºr Fehler 1. Art",
  "$\\beta$", "*beta*", "-- Symbol f√ºr Regressionskoeffizienten<br>-- Zeichen f√ºr Fehler 2. Art",
  "$\\delta$", "*delta*", "Symbol f√ºr allgemeine zusammenfassende Statistik",
  "$\\epsilon$",  "*epsilon*",  "Symbol f√ºr Fehler",
  "$\\mu$", "*my*", "Symbol f√ºr den Populationsmittelwert",
  "$\\sigma$", "*sigma*", "Symbol f√ºr die Populationsstandardabweichung",
  "$\\pi$", "*pi*", "Symbol f√ºr den Populationsanteil",
  "$\\rho$", "*rho*", "Symbol f√ºr den Populationskorrelation",
  "$\\chi$",  "*chi*", "Symbol f√ºr zusammenfassende Statistik im $\\chi^2$-Test"
) |>
  knitr::kable(
    # format = "latex",
    col.names = c("Buchstabe"," ", "Bedeutung in der Regel"),
    align = "lll",
    escape = TRUE)
# |> xtable() |> print(sanitize.text.function = function(x) {x})

```


::: {.callout-tip .Tipp}
## Tipp

Schon mal merken: Griechische Buchstaben werden in Hypothesen verwendet, da diese sich immer auf die Population beziehen. Lateinische Buchstaben werden f√ºr Aussagen zur Stichprobe verwendet.
:::

Eine letzte wichtige Unterscheidung ist die zwischen Experiment und Beobachtungsstudie. In einem Experiment werden die Werte der unabh√§ngigen Variablen manipuliert. Als Beispiel sei hier eine Untersuchung zu einem neuen Medikament gew√§hlt: Eine Gruppe bekommt den Wirkstoff, die andere ein Placebo (sogenannte Kontrollgruppe). Die Gruppen werden zuf√§llig zugeordnet und die Teilnehmer wissen nicht, ob sie den Wirkstoff oder das Placebo bekommen. Wenn deutlich mehr in der Gruppe derjenigen, die den Wirkstoff bekommen haben, eine Linderung der Symptome zeigen als in der Kontrollgruppe, zeigt das die Wirksamkeit des neuen Wirkstoffs.

Ein Experiment erlaubt direkt einen Kausalschluss, was in der Beobachtungsstudie nicht so ohne weiteres m√∂glich ist. Eigentlich wollen wiraber in der Regel wissen, warum etwas passiert (also z. B. eine l√§ngere Lernzeit f√ºhrt zu mehr Klausurpunkten). Das Thema greifen wir im Kapitel Kausale Modellierung auf und lernen, unter welchen Bedingungen auch in Beobachtungsstudien Kausalschl√ºsse gezogen werden k√∂nnen.

Auch hier kann eine Abbildung den Zusammenhang noch einmal verdeutlichen. Ein fiktives Beispiel:

-   Sei $Z$ das Vorwissen eines Studierenden.

-   Sei $X$ die Lernzeit eines Studierenden.

-   Sei $Y$ die Klausurpunktzahl.
    Die Dozentin will den Zusammenhang $X \rightarrow Y$ untersuchen.

Es kann vermutet werden:

-   Studierende mit einem hohen Vorwissen m√ºssen weniger lernen $Z \xrightarrow{-} X$ , erreichen aber mehr Punkte: $Z \xrightarrow{+} Y$.

-   Studierende, die mehr lernen, erreichen mehr Punkte: $X \xrightarrow{+} Y$.

Aufgrund des h√∂heren Vorwissens ist es m√∂glich, dass Studierende mit einer geringeren Lernzeit mehr Punkte erreichen -- obwohl bei gleichem Vorwissen der Zusammenhang positiv ist.

In einem randomisierten Experiment w√ºrde die Dozentin die Lernzeit zuf√§llig zuordnen -- unabh√§ngig vom Vorwissen.

Der Graph zeigt den **datengenerierenden Prozess** in einer Beobachtungsstudie und einem randomisierten Experiment. 
Im letzteren weist die Dozentin den Studierenden **zuf√§llig** eine Lernzeit zu.

```{r}
#| fig-cap: "Beobachtungsstudie vs. Experiment"
#| label: fig-DAG-Experiment
#| echo: false
#| fig-width: 7
#| fig-asp: 0.5
#| out-width: 10cm

layout <- rbind(c(rep(1,10), NA, rep(2, 10)))
grid.arrange(dag_e1, dag_e2, layout_matrix = layout)
```


Das Vorwissen w√ºrde die Lernzeit und die Klausurpunkte beeinflussen. 
Durch das Experiment wird der Pfad zwischen Vorwissen und Lernzeit gekappt, so dass der Einfluss der Lernzeit isoliert werden kann.

::: column-margin
![PPDAC: Problem -- Plan -- Data -- Analysis -- Conclusion](own-images/PPDAC.png){#fig-PPDAC}
:::

Zum Abschluss dieses Kapitels sehen Sie in @fig-PPDAC den idealisierten Ablauf eines Forschungsprozesses, den Problem-Plan-Data-Analysis-Conclusion-Zyklus (PPDAC-Zyklus).

Welches Problem soll untersucht werden (P), welche Variablen sind daf√ºr notwendig und m√ºssen diese ggf. operationalisiert werden (P), wie kommen Sie an die Daten (D). 
Mit der Analyse (A) und der Schlussfolgerung (Conclusion, C) befassen wir uns in den folgenden Kapiteln.

::: {.callout-caution .Lernpfad}
## Lernpfad **Grundlagen der quantitativen Datenanalyse**

-   Bearbeiten Sie die √úbungen, falls Sie diese noch nicht absolviert haben. -- Die L√∂sungen finden Sie am Ende des Kapitels.

-   Kl√§ren Sie erforderlichenfalls Ihnen noch unbekannte Begriffe und Sachverhalte eigenst√§ndig.

-   Zur Unterst√ºtzung gibt es drei Screencasts: Messen <https://vimeo.com/459322423>, Datenerhebung <https://vimeo.com/459322742> und Grundlagen <https://vimeo.com/398512087>. Die Videos erfordern ein Passwort: FOMtest.

-   Lesen Sie zur Vertiefung Kapitel 1 (falls noch nicht geschehen) sowie das Kapitel 2 aus dem Buch Introduction to Modern Statistics \[6\]. Sie k√∂nnen es hier herunterladen: <https://openintro-ims.netlify.app/index.html>.

-   Zur √úberpr√ºfung Ihres Lernstands bearbeiten Sie bitte die restlichen Wiederholungsfragen unter folgenden Link: <https://fomshinyapps.shinyapps.io/Lernfortschrittskontrolle_01/> sowie fongende Wiederholungsfragen: <https://fomshinyapps.shinyapps.io/Lernfortschrittskontrolle_02/>
:::

::: {.callout-tip .Zusammenfassung}
## Zusammenfassung

Halten wir fest, was Sie in diesem Kapitel gelernt haben:

-   Sie k√∂nnen die Skalenniveaus von Daten zuordnen.

-   Sie verstehen, worauf Sie bei einer Messung achten m√ºssen.

-   Sie k√∂nnen zwischen unabh√§ngigen und abh√§ngigen Variablen sowie Kovariablen unterscheiden.

-   Sie wissen, warum Sie eine Stichprobe ben√∂tigen und was Sie bei dem Ziehen einer Stichprobe beachten m√ºssen.

-   Sie haben gelernt, dass Kausalschl√ºsse (A verursacht B) ohne weiteres nur bei Experimenten m√∂glich sind.

-   Sie k√∂nnen den PPDAC (zumindest PPD) z. B. auf eine Fragestellung aus Ihrer beruflichen Praxis anwenden.
:::

## L√∂sungshinweise

**Aufgabe 4.1**\

Sowohl bei der Messung als auch bei der Forschung gibt es Transparenz bzw. Reproduzierbarkeit (bei der Messung bezeichnen wir das als Reliabilit√§t), Objektivit√§t und Validit√§t. Letztere wird bei der Forschung noch unterschieden in interne und externe Validit√§t. Zus√§tzlich gibt es bei der Messung noch die Genauigkeit einer Messung und bei der Forschung spielen auch die ethischen Aspekte eine wichtige Rolle.

**Aufgabe 4.2**\

Nein, die gleichen Temperaturen entsprechen in Fahrenheit 50 Grad Fahrenheit und 68 Grad Fahrenheit -- keine Verdoppelung. 0 Grad Celsius ist kein absoluter Nullpunkt, sondern willk√ºrlich gew√§hlt (die Temperatur, bei dem Eis schmilzt). Die angegebenen Temperatur entsprichen ca. 283 bzw. ca. 293 Kelvin, in der Kelvinskala gibt es einen absoluten Nullpunkt.

Die Relation der Werte (Temperatur) entspricht nicht der Relation der Eigenschaft (W√§rme). Bei 0 Grad Celsius ist uns kalt, bei 0 Kelvin ist mensch tot.

**Aufgabe 4.3**\

Obwohl eine Telefonnummer aus Ziffern besteht, kann damit nicht gerechnet werden, daher nicht metrisch. Auch eine Sortierung ist nicht m√∂glich. Somit ist die Telefonnummer eine kategoriales, nominalskaliertes Merkmal.

**Aufgabe 4.6**\

Unterschiedliche Lernzeiten der Studierenden, unterschiedliche Verfassung am Tag der Klausur, unterschiedliche Fachkompetenz, ...

**Aufgabe 4.7**\

Edward Hugh Simpson war ein britischer Statistiker, der das Ph√§nomen 1951 beschrieb. Ihm fiel auf, dass die Bewertung verschiedener Gruppen unterschiedlich ausf√§llt in Abh√§ngigkeit davon, ob die Gruppen kombiniert werden oder nicht.

**Aufgabe 4.8**\

a)  Vermutlich die Gruppe der gewissenhaft Studierenden, da gewissenhafte Menschen evtl. durch ein h√∂heres Pflichtbewusstsein eher (freiwillige) Aufgaben √ºbernehmen k√∂nnten.

b)  Zweite Frage: Vermutlich ebenfalls die Gruppe der gewissenhaft Studierenden.

Es kann also passieren, dass sich die Gruppe derjenigen, die an der Umfrage teilnehmen, in der Lernzeit von denjenigen unterscheidet, die nicht teilnehmen.

*Hinweis:* In den n√§chsten Kapiteln lernen Sie, wie Sie solche Hypothesen empirisch √ºberpr√ºfen k√∂nnen.
